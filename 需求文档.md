# 图片水印GUI应用需求文档

## 1. 项目概述
开发一个基于Python的本地GUI应用程序，用于为图片添加文本或图片水印，并支持批量处理功能。

## 2. 功能需求

### 2.1 文件处理

#### 2.1.1 导入图片
- 支持单张图片拖拽或通过文件选择器导入
- 支持批量导入，可一次性选择多张图片或直接导入整个文件夹
- 在界面上显示已导入图片的列表（缩略图和文件名）

#### 2.1.2 支持格式
- **输入格式**：
  - 必须支持：JPEG, PNG（含透明通道）
  - 强烈建议支持：BMP, TIFF
- **输出格式**：用户可选择输出为 JPEG 或 PNG

#### 2.1.3 导出图片
- 用户可指定一个输出文件夹，默认禁止导出到原文件夹
- 提供导出文件命名规则选项：
  - 保留原文件名
  - 添加自定义前缀（如 wm_）
  - 添加自定义后缀（如 _watermarked）
- 对于 JPEG 格式，提供图片质量（压缩率）调节滑块（0-100）【高级功能】
- 导出时允许用户调整图片尺寸（如按宽度、高度或百分比缩放）【高级功能】

### 2.2 水印类型

#### 2.2.1 文本水印
- 内容：用户可自定义输入任意文本
- 字体：可选择系统已安装的字体、字号、粗体、斜体【高级功能】
- 颜色：提供调色板让用户选择字体颜色【高级功能】
- 透明度：可调节文本的透明度（0-100%）
- 样式：可添加阴影或描边效果，以增强在复杂背景下的可读性【高级功能】

#### 2.2.2 图片水印
- 用户可从本地选择一张图片（如Logo）作为水印
- 必须支持带透明通道的 PNG 图片
- 缩放：可按比例或自由调整图片水印的大小
- 透明度：可调节图片水印的整体透明度（0-100%）

### 2.3 水印布局与样式

#### 2.3.1 实时预览
- 所有对水印的调整都应在主预览窗口中实时显示效果
- 用户可以点击图片列表切换预览不同的图片

#### 2.3.2 位置
- 预设位置：提供九宫格布局（四角、正中心），用户可一键将水印放置在这些位置
- 手动拖拽：用户可以直接在预览图上通过鼠标拖拽水印到任意位置

#### 2.3.3 旋转
- 提供一个滑块或输入框，允许用户以任意角度旋转水印【高级功能】

### 2.4 配置管理

#### 2.4.1 水印模板
- 用户可以将当前的水印设置（包括水印内容、字体、颜色、位置、大小、透明度等所有参数）保存为一个模板
- 用户可以加载、管理和删除已保存的模板
- 程序启动时可自动加载上一次关闭时的设置或一个默认模板

## 3. 技术需求

### 3.1 开发语言与框架
- 开发语言：Python 3.8+
- GUI框架：推荐使用PyQt5/PySide6或Tkinter（确保跨平台兼容性）
- 图像处理库：Pillow (PIL) 或 OpenCV

### 3.2 操作系统支持
- 兼容Windows、macOS和Linux主流操作系统

### 3.3 性能要求
- 批量处理10张普通大小（2-5MB）图片时，处理时间不应超过30秒
- 实时预览响应延迟不超过0.5秒

## 4. 用户界面设计

### 4.1 主界面布局
- 左侧：图片列表区域，显示已导入图片的缩略图和文件名
- 右侧上方：预览区域，实时显示水印效果
- 右侧下方：水印设置面板，包含文本/图片水印切换、参数调整等控件
- 底部：操作按钮区域（添加图片、移除图片、应用水印、导出等）

### 4.2 交互设计
- 简洁直观的操作流程，减少用户学习成本
- 提供键盘快捷键支持常用操作
- 所有设置变更应有即时反馈

## 5. 非功能性需求

### 5.1 可用性
- 界面友好，操作简单，适合不同技术水平的用户
- 提供适当的提示信息和错误处理

### 5.2 稳定性
- 程序应能稳定运行，处理各种异常情况（如无效图片、磁盘空间不足等）
- 提供日志记录功能，便于故障排查

### 5.3 可扩展性
- 代码结构清晰，模块化设计，便于未来功能扩展
- 考虑添加插件机制，支持第三方功能扩展

## 6. 开发计划

### 6.1 阶段一：基础架构
- 搭建GUI框架
- 实现图片导入/导出功能
- 开发简单的预览功能

### 6.2 阶段二：水印功能
- 实现文本水印基本功能
- 实现图片水印基本功能
- 开发水印位置调整功能

### 6.3 阶段三：高级功能
- 完善字体、颜色等高级设置
- 实现水印模板管理
- 开发批量处理功能

### 6.4 阶段四：优化与测试
- 性能优化
- 界面美化
- 全面测试与Bug修复

## 7. 验收标准

### 7.1 功能完整性
- 所有基本功能必须正常工作
- 高级功能在时间允许范围内实现

### 7.2 性能测试
- 按照性能要求进行测试，确保满足指标

### 7.3 用户体验
- 进行用户测试，收集反馈并进行优化
- 确保界面美观、操作流畅

---

*注：高级功能可根据开发时间和资源情况进行优先级调整或分阶段实现。*